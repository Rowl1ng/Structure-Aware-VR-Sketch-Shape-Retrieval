work_dir: /vol/research/sketching/projects/VR_Sketch_lightning/project
print_config: true
ignore_warnings: true
test_after_training: true
seed: 12345
name: adaptive_triplet_multickpt_0.3_1.2_1
resume_training: true
inference: false
radius: 0.01
ckpt_path: null
load_deformer: true
trainer:
  _target_: pytorch_lightning.Trainer
  gpus: -1
  max_epochs: 500
  min_epochs: 300
  check_val_every_n_epoch: 5
  gradient_clip_val: 0.05
  num_sanity_val_steps: 1
  progress_bar_refresh_rate: 10
  weights_summary: null
  default_root_dir: lightning_logs/
model:
  num_points: ${datamodule.num_points}
  transform: false
  _target_: src.models.deformer_retrieval_multifold.Deformer_Retrieval_fitting_gap
  use_xyz: true
  margin: 0.3
  symmetric: false
  encoder: pointnet2_msg
  feat_dim: 512
  lambda_deform_triplet: 0
  deform_margin: 0.1
  aug_sketch: false
  aug_shape: false
  val_deform: Falsef
  steps_KP: 100
  num_structure_points: 12
  KP_dist: Chamfer_dist
  deformer_ckpt: logs/experiments/deformer_cage_sh2sh_template/checkpoints/last.ckpt
  lambda_deform_sketch: 0
  use_sketch_deformer: false
  sketch_deformer_ckpt: logs/experiments/deformer_cage_sk2sh_template/checkpoints/last.ckpt
  deform_sketch_loss: deform_sketch_loss_v1
  deform_sketch_margin: 0.3
  cage_size: 1.4
  ico_sphere_div: 1
  n_influence_ratio: 1.0
  lambda_init_points: 2.0
  lambda_chamfer: 1.0
  lambda_influence_predict_l2: 1000000.0
  optimizer: sgd
  weight_decay: 0.0
  lr: 0.01
  schedular: step
  lr_decay: 0.7
  bn_momentum: 0.5
  bnm_decay: 0.5
  decay_step: 20000.0
  batch_size: ${datamodule.batch_size}
  step_size: 80
  gamma: 0.7
  stage2_deform_only: false
  tl_loss: true
  lambda_KP_dist: 1.0
  lambda_sym: 0.0
  loss_type: regression_triplet
  regression_triplet_loss: regression_triplet_loss_v7
  regression_loss: L1
  neg_ratio: 1.0
  sigma_lr: 0.1
  fixed_sigma: true
  softmax_weight: 1.0
  L2_norm: true
  val_metric: acc@1
  margin_max: 1.2
  top2_max: null
  learn_margin: false
  margin_range: 0.9
  fitting_gap: d2
  work_dir: ${work_dir}
  vis: true
  save_dir: ${work_dir}
  fold_id: ${datamodule.fold_id}
  sketch_dir: ${datamodule.sketch_dir}
  test_ckpt: best
  test_data: ${datamodule.test_data}
datamodule:
  _target_: src.datamodules.SketchyVR_datamodule.SketchyVRDataModule_multifold
  batch_size: 10
  data_dir: /vol/vssp/datasets/multiview/3VS/datasets/FineGrained_3DSketch
  mesh_dir: /vol/vssp/datasets/multiview/3VS/datasets/ShapeNet/shapenet
  split_file: /vol/research/sketching/projects/VR_Sketch_lightning/project/data/shapenet_split/all.csv
  category: '03001627'
  dataset_loader: SketchyVR_original
  train_list: list/multifold/fold_{}_train.txt
  train_shape_list: list/multifold/fold_{}_train.txt
  val_list: list/hs/val.txt
  val_shape_list: list/hs/val.txt
  test_list: list/hs/test.txt
  test_shape_list: list/hs/test_shape.txt
  source_type: sketch
  target_type: shape
  num_points: 1024
  num_workers: 4
  pin_memory: false
  origin_val: true
  sketch_dir: aligned_sketch
  fold_id: 1
  test_data: sketch_21_test
callbacks:
  model_checkpoint1:
    _target_: src.callbacks.custom_callbacks.SelfModelCheckpoint
    monitor: val_CD_d@1
    save_top_k: 1
    save_last: true
    mode: min
    dirpath: checkpoints
    filename: '{val_CD_d@1:.3f}-{epoch}'
  model_checkpoint2:
    _target_: src.callbacks.custom_callbacks.SelfModelCheckpoint
    monitor: val_bi_CD_d@1
    save_top_k: 1
    save_last: false
    mode: min
    dirpath: checkpoints
    filename: '{val_bi_CD_d@1:.3f}-{epoch}'
  model_checkpoint3:
    _target_: src.callbacks.custom_callbacks.SelfModelCheckpoint
    monitor: val_CD_d@5
    save_top_k: 1
    save_last: false
    mode: min
    dirpath: checkpoints
    filename: '{val_CD_d@5:.3f}-{epoch}'
  model_checkpoint4:
    _target_: src.callbacks.custom_callbacks.SelfModelCheckpoint
    monitor: val_bi_CD_d@5
    save_top_k: 1
    save_last: false
    mode: min
    dirpath: checkpoints
    filename: '{val_bi_CD_d@5:.3f}-{epoch}'
  LearningRateMonitor:
    _target_: pytorch_lightning.callbacks.lr_monitor.LearningRateMonitor
logger:
  csv_logger:
    _target_: pytorch_lightning.loggers.csv_logs.CSVLogger
    save_dir: .
    name: csv_logger/
  tensorboard:
    _target_: pytorch_lightning.loggers.tensorboard.TensorBoardLogger
    save_dir: ''
    name: ''
    version: tb_logs
